
const promos=[{promo:"123456",discount:10},{promo:"654321",discount:20},{promo:"987654",discount:30}];
fetch("../json/products.json").then((e=>e.json())).then((e=>{const t=e.map((e=>{const t=(e.price-e.initiallPrice)/e.initiallPrice*100;return{...e,priceDifference:t}})).sort(((e,t)=>t.priceDifference-e.priceDifference));if(window.location.pathname.includes("product-card.html")){const e=JSON.parse(localStorage.getItem("selectedProduct"));if(e){document.querySelector(".product-card-info-img img").src=e.images[0];const c=document.querySelectorAll(".next-images-line img");e.images.forEach(((e,t)=>{c[t]&&(c[t].src=e,c[t].addEventListener("click",(function(){document.querySelector(".product-card-info-img img").src=this.src})))})),document.querySelector(".product-price").textContent=`${e.price} грн.`,document.querySelector("#heightJsBlockCard h2").textContent=e.name;const n=document.querySelectorAll("#heightJsBlockCard p");n.length>0&&(n[0].textContent=e.description);const r=document.querySelector(".card-btns .button");r.addEventListener("click",(function(){event.preventDefault(),"В кошику"==r.innerHTML&&document.querySelector(".basket-popup-js").classList.toggle("basket-active")}));JSON.parse(localStorage.getItem("basketProducts")||"[]").includes(e.id)?r.innerHTML="В кошику":(r.setAttribute("data-value",e.id),r.addEventListener("click",(function(){const e=Number(this.getAttribute("data-value"));addToBasket(e),r.innerHTML="В кошику"})));const i=document.querySelector("#productCardsSimilar");if(i){t.filter((t=>t.category===e.category&&t.id!==e.id)).forEach((e=>{const t=document.createElement("figure");t.className="col-6 col-md-4 col-lg-3",t.innerHTML=`\n                  <figcaption>\n                    <div class="figure-image">\n                      <img src="${e.images[0]}" alt="">\n                      <a class="figure-to-card-page" href="product-card.html" data-product-id="${e.id}"></a>\n                    </div>\n                    <div class="card-text-block d-flex justify-content-between w-100">\n                      <a class="description-card" href="product-card.html" data-product-id="${e.id}">\n                        <p>${e.name}</p>\n                        <p class="price">${e.price} грн.</p>\n                      </a>\n                      <a class="card-btn al-center d-flex justify-content-center" data-value='${e.id}' href="#">\n                        <img src="${JSON.parse(localStorage.getItem("basketProducts")||"[]").includes(e.id)?"img/tick.svg":"img/cart.svg"}" alt="">\n                      </a>\n                    </div>\n                  </figcaption>\n                `,i.appendChild(t)}))}}}}));
JSON.parse(localStorage.getItem("basketProducts")||"[]").length>0&&(document.querySelector(".triangle").style.transform="scale(1)"),document.querySelector(".header-underline")&&localStorage.getItem("selectedProduct")&&localStorage.removeItem("selectedProduct"),document.addEventListener("DOMContentLoaded",(()=>{const e=localStorage.getItem("selectedCategory"),t=document.querySelector("#productsCategory");if(window.location.pathname.includes("category.html")&&t&&e){const n={Electronics:"Електроніка",Clocks:"Годинники",Dishes:"Посуд",Models:"Статуетки, моделі",Art:"Мистецтво",Other:"Інше"};document.querySelector(".categories-main h1").innerHTML=n[e],fetch("../json/products.json").then((e=>e.json())).then((n=>{const o=n.map((e=>{const t=(e.price-e.initiallPrice)/e.initiallPrice*100;return{...e,priceDifference:t}})).sort(((e,t)=>t.priceDifference-e.priceDifference)).filter((t=>t.category===e));console.log(t),o.forEach((e=>{const n=`\n                <figure class="col-6 col-md-4 col-lg-3">\n                  <figcaption>\n                    <div class="figure-image">\n                      <img src="${e.images[0]}" alt="${e.name}">\n                      <a href="product-card.html" class="figure-to-card-page" data-product-id="${e.id}"></a>\n                    </div>\n                    <div class="card-text-block d-flex justify-content-between w-100">\n                      <a href="product-card.html" class="description-card" data-product-id="${e.id}">\n                        <p>${e.name}</p>\n                        <p class="price">${e.price} грн.</p>\n                      </a>\n                      <a href="#" data-value="${e.id}" class="${JSON.parse(localStorage.getItem("basketProducts")||"[]").includes(e.id)?"cart-open-btn":""} card-btn al-center d-flex justify-content-center">\n                        <img src="${JSON.parse(localStorage.getItem("basketProducts")||"[]").includes(e.id)?"img/tick.svg":"img/cart.svg"}" alt="cart">\n                      </a>\n                    </div>\n                  </figcaption>\n                </figure>\n              `;document.querySelectorAll(".cart-open-btn"),document.querySelector(".basket-popup-js");t.insertAdjacentHTML("beforeend",n)}))}))}})),document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelector(".burger-list"),t=e.querySelector(".burger span"),n=document.querySelector(".header-sm-popup"),o=n.querySelectorAll("a");e.addEventListener("click",(function(){window.innerWidth<=768&&(t.classList.toggle("active"),n.classList.toggle("popup-active"))})),o.forEach((function(e){e.addEventListener("click",(function(){window.innerWidth<=768&&(n.classList.remove("popup-active"),t.classList.remove("active"))}))}))})),document.addEventListener("DOMContentLoaded",(function(){document.querySelectorAll(".products figure").forEach((e=>{e.addEventListener("mouseenter",(function(){this.querySelector(".card-btn:hover")||this.classList.add("show-circle")})),e.addEventListener("mouseleave",(function(){this.classList.remove("show-circle")}));const t=e.querySelector(".card-btn");t&&(t.addEventListener("mouseenter",(function(){e.classList.remove("show-circle")})),t.addEventListener("mouseleave",(function(){e.classList.add("show-circle")})))}))})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("nav-list").querySelectorAll("a[data-section]"),t=new IntersectionObserver((t=>{t.forEach((t=>{if(t.isIntersecting){const n=t.target.id;e.forEach((e=>{e.getAttribute("data-section")===n?e.parentElement.classList.add("active"):e.parentElement.classList.remove("active")}))}}))}),{threshold:.5});["search","categories","aboutus","form"].forEach((e=>{const n=document.getElementById(e);n&&t.observe(n)}))})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelectorAll(".cart-open-btn"),t=document.querySelector(".basket-popup-js");e.forEach((e=>{e.addEventListener("click",(e=>{e.preventDefault(),t.classList.toggle("basket-active")}))}));const n=document.querySelectorAll(".checkout-btn"),o=document.querySelector(".check-out-popup-js");n.forEach((e=>{e.addEventListener("click",(()=>{event.preventDefault();0!==(JSON.parse(localStorage.getItem("basketProducts"))||[]).length&&(t.classList.toggle("basket-active"),o.classList.toggle("basket-active"))}))}))})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelector("#heightJsBlockCard"),t=document.querySelector("#takeJsHeight");e&&window.innerWidth>=991&&(e.style.height=t.getBoundingClientRect().height+"px")})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelector(".next-images-line"),t=document.querySelector(".product-card-info-img .bgwhite > img");e&&e.addEventListener("click",(e=>{if("IMG"===e.target.tagName){const n=e.target.getAttribute("src");t.setAttribute("src",n)}}))})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelector(".check-out-open-ready-popup"),t=document.querySelector(".succsessful-order");e.addEventListener("click",(e=>{const n=document.getElementById("checkOutForm"),o=n.querySelectorAll('input:not([name="userPromo"])');let c=!0;if(o.forEach((e=>{e.value.trim()||(c=!1)})),c){e.preventDefault(),console.log(2),document.querySelector(".check-out-popup-js").classList.toggle("basket-active");const o={name:n.querySelector('input[name="userName"]').value,phone:n.querySelector("#phoneInput").value,promo:n.querySelector('input[type="text"][name="userPromo"]').value,deliveryType:n.querySelector('input[name="deliveryType"]:checked').nextElementSibling.textContent,city:n.querySelector('input[name="city"]').value,department:n.querySelector('input[name="department"]').value},c=JSON.parse(localStorage.getItem("basketProducts"))||[];(async()=>{const e=await fetch("../json/products.json"),n=await e.json(),r=c.map((e=>{const t=n.find((t=>t.id===e));return t?{name:t.name,price:t.price,photo:t.images[0]}:null})).filter(Boolean);console.log(r);let a=r.reduce(((e,t)=>e+t.price),0),s=a;!async function(){try{const e=await fetch("../json/promocodes.json"),n=(await e.json()).find((e=>e.promo===o.promo));n&&(s=a-a*n.discount/100);const c=r.map((e=>`${e.name} - ${e.price} грн`)).join("\n"),i=r.map((e=>e.photo));console.log(i);const l=`\n<b>Нове замовлення!</b>\n<b>Ім'я:</b> ${o.name}\n<b>Телефон:</b> ${o.phone}\n<b>Промокод:</b> ${o.promo||"Не вказано"}\n<b>Спосіб доставки:</b> ${o.deliveryType}\n<b>Місто:</b> ${o.city}\n<b>Відділення:</b> ${o.department}\n<b>Замовлені товари:</b>\n${c}\n<b>Загальна сума без знижки:</b> ${a} грн\n<b>Загальна сума до сплати:</b> ${s} <i>грн ${o.promo?"(з урахуванням промокоду)":""}</i>\n            `,d="7936445587:AAHV5lZ4RV6fW2w5vE75qfMRg27VUtuDDo0",u="-1002442277202";await fetch(`https://api.telegram.org/bot${d}/sendMessage`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chat_id:u,text:l,parse_mode:"HTML"})}),setTimeout((()=>{i.forEach((async e=>{console.log(e);const t="https://raw.githubusercontent.com/Franchukkk/antik/refs/heads/master/docs/"+e;try{await fetch(`https://api.telegram.org/bot${d}/sendPhoto`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chat_id:u,photo:t})})}catch(e){console.error("Помилка:",e)}}))}),1e3),t.classList.toggle("d-none"),localStorage.clear()}catch(e){console.error("Error loading the JSON file:",e)}console.log(s)}()})()}}))}));const productsContainer=document.querySelector("#products"),basketContainer=document.querySelector("#productsInBasket"),totalPriceContainer=document.querySelector("#totalPrice"),checkoutBtn=document.querySelector("#checkoutBtn"),productsByCategory={};function updateProducts(){fetch("../json/products.json").then((e=>e.json())).then((e=>{e.map((e=>{const t=(e.price-e.initiallPrice)/e.initiallPrice*100;return{...e,priceDifference:t}})).sort(((e,t)=>t.priceDifference-e.priceDifference)).slice(0,12).forEach((e=>{const t=`\n                        <figure class="col-6 col-md-4 col-lg-3">\n                            <figcaption>\n                                <div class="figure-image">\n                                    <img src="${e.images[0]}" alt="${e.name}">\n                                    <a href="product-card.html" class="figure-to-card-page" data-product-id="${e.id}"></a>\n                                </div>\n                                <div class="card-text-block d-flex justify-content-between w-100">\n                                    <a href="product-card.html" class="description-card" data-product-id="${e.id}">\n                                        <p>${e.name}</p>\n                                        <p class="price">${e.price} грн.</p>\n                                    </a>\n                                    <a href="#" data-value="${e.id}" class="${JSON.parse(localStorage.getItem("basketProducts")||"[]").includes(e.id)?"cart-open-btn":""} card-btn al-center d-flex justify-content-center">\n                                        <img src="${JSON.parse(localStorage.getItem("basketProducts")||"[]").includes(e.id)?"img/tick.svg":"img/cart.svg"}" alt="cart">\n                                    </a>\n                                </div>\n                            </figcaption>\n                        </figure>\n                    `;document.querySelectorAll(".cart-open-btn"),document.querySelector(".basket-popup-js");productsContainer&&productsContainer.insertAdjacentHTML("beforeend",t)}))}))}function addToBasket(e){document.querySelector(".triangle").style.transform="scale(0)";let t=JSON.parse(localStorage.getItem("basketProducts"))||[];t.includes(e)||(t.push(e),localStorage.setItem("basketProducts",JSON.stringify(t))),updateBasket(),setTimeout((()=>{document.querySelector(".triangle").style.transform="scale(1)"}),100)}function removeFromBasket(e){let t=JSON.parse(localStorage.getItem("basketProducts"))||[];t=t.filter((t=>t!==e)),localStorage.setItem("basketProducts",JSON.stringify(t)),setTimeout((()=>{updateBasket()}),100)}function updateBasket(){let e=JSON.parse(localStorage.getItem("basketProducts"))||[];if(e=e.filter((e=>null!==e)),localStorage.setItem("basketProducts",JSON.stringify(e)),basketContainer.innerHTML="",0===e.length)return basketContainer.innerHTML="<h2>Кошик пустий</h2>",totalPriceContainer.textContent="Кошик пустий",checkoutBtn.disabled=!0,void(document.querySelector(".triangle").style.transform="scale(0)");let t=0;e.forEach((e=>{fetch("../json/products.json").then((e=>e.json())).then((n=>{const o=n.map((e=>{const t=(e.price-e.initiallPrice)/e.initiallPrice*100;return{...e,priceDifference:t}})).sort(((e,t)=>t.priceDifference-e.priceDifference)),c=o.find((t=>t.id===e));if(c){t+=c.price;const e=`\n                            <div class="col-6 col-md-4 col-lg-3">\n                                <figure class="figure-basket">\n                                    <figcaption>\n                                        <div class="figure-image">\n                                            <img src="${c.images[0]}" alt="${c.name}">\n                                            <a href="product-card.html" class="figure-to-card-page" data-product-id="${c.id}"></a>\n                                        </div>\n                                        <div class="card-text-block d-flex justify-content-between w-100">\n                                            <a href="product-card.html" class="description-card" data-product-id="${c.id}">\n                                                <p>${c.name}</p>\n                                                <p class="price">${c.price} грн.</p>\n                                            </a>\n                                            <a href="#" onclick="removeFromBasket(${c.id})" class="card-btn al-center d-flex justify-content-center align-items-center">\n                                                <img src="img/cross.svg" alt="remove">\n                                            </a>\n                                        </div>\n                                    </figcaption>\n                                </figure>\n                            </div>\n                        `;basketContainer.insertAdjacentHTML("beforeend",e)}totalPriceContainer.textContent=""+(0!=t?t+"грн.":"Кошик пустий"),document.querySelector("#allPriceWithPromo").textContent=""+(0!=t?t+"грн.":"Кошик пустий"),checkoutBtn.disabled=!1}))}))}fetch("../json/products.json").then((e=>e.json())).then((e=>{e.map((e=>{const t=(e.price-e.initiallPrice)/e.initiallPrice*100;return{...e,priceDifference:t}})).sort(((e,t)=>t.priceDifference-e.priceDifference)).forEach((e=>{productsByCategory[e.category]||(productsByCategory[e.category]=[]),productsByCategory[e.category].length<2&&productsByCategory[e.category].push(e)}))})),updateProducts(),document.addEventListener("click",(e=>{if(e.target.closest(".card-btn")){e.preventDefault(),e.target.closest(".card-btn").classList.add("cart-open-btn"),e.target.closest(".card-btn").querySelector("img").src="img/tick.svg",e.target.closest(".card-btn").addEventListener("click",(()=>{n.classList.toggle("basket-active")}));const t=parseInt(e.target.closest(".card-btn").dataset.value),n=(document.querySelectorAll(".cart-open-btn"),document.querySelector(".basket-popup-js"));addToBasket(t)}e.target.closest('a[href="product-card.html"]')&&fetch("../json/products.json").then((e=>e.json())).then((t=>{const n=t.map((e=>{const t=(e.price-e.initiallPrice)/e.initiallPrice*100;return{...e,priceDifference:t}})).sort(((e,t)=>t.priceDifference-e.priceDifference)),o=parseInt(e.target.closest("a").dataset.productId),c=n.find((e=>e.id===o));c&&localStorage.setItem("selectedProduct",JSON.stringify(c))}))})),document.querySelector("#cartUpdate").addEventListener("click",(()=>{updateBasket()}));const promoInput=document.querySelector('input[name="userPromo"]');console.log(promoInput),promoInput.addEventListener("input",(e=>{fetch("../json/promocodes.json").then((e=>e.json())).then((t=>{console.log(t);const n=e.target.value,o=t.find((e=>e.promo===n)),c=document.querySelector("#allPriceWithPromo"),r=parseInt(c.textContent);if(o&&r){const e=r-r*(o.discount/100);c.textContent=`${Math.round(e)}грн.`,document.querySelector("#isPromoUsed").textContent="Промокод (застосовано)",localStorage.setItem("promo",n)}else c.textContent=document.querySelector("#totalPrice").textContent,document.querySelector("#isPromoUsed").textContent="Промокод"})).catch((e=>console.error("Error loading the JSON file:",e)))})),document.addEventListener("DOMContentLoaded",(()=>{document.querySelector(".contact-form#form")&&document.querySelector(".contact-form#form").addEventListener("submit",(async e=>{e.preventDefault();const t=e.target.querySelectorAll("input"),n=`\nНове звернення:\nІм'я: ${t[0].value}\nТелефон: ${t[1].value}\nМесенджер: ${t[2].value}\nПовідомлення: ${t[3].value}\n    `;try{if(!(await fetch("https://api.telegram.org/bot7936445587:AAHV5lZ4RV6fW2w5vE75qfMRg27VUtuDDo0/sendMessage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chat_id:"-1002442277202",text:n})})).ok)throw new Error("Помилка при відправці");e.target.reset()}catch(e){console.error(e)}document.querySelector(".succsessful-feedback").classList.toggle("d-none")}))}));const feedbackOutOpenReadyPopup=document.querySelectorAll(".feedback-popup-open"),succsessfulFeedback=document.querySelector(".succsessful-feedback");feedbackOutOpenReadyPopup.forEach((e=>{e.addEventListener("click",(e=>{e.preventDefault(),succsessfulFeedback.classList.toggle("d-none")}))}));const categoryLinks=document.querySelectorAll(".category-link");categoryLinks.forEach((e=>{e.addEventListener("click",(e=>{const t=e.currentTarget.dataset.value;localStorage.setItem("selectedCategory",t)}))}));const readMoreBtns=document.querySelectorAll(".read-more-btn"),mobileHiddenContents=document.querySelectorAll(".mobile-hidden");readMoreBtns.forEach(((e,t)=>{e.addEventListener("click",(()=>{mobileHiddenContents[t].classList.toggle("mobile-hidden"),e.textContent=mobileHiddenContents[t].classList.contains("mobile-hidden")?"Читати далі":"Згорнути"}))}));
fetch("../json/products.json").then((e=>e.json())).then((e=>{const c=e.map((e=>{const c=(e.price-e.initiallPrice)/e.initiallPrice*100;return{...e,priceDifference:c}})).sort(((e,c)=>c.priceDifference-e.priceDifference));console.log(localStorage.getItem("searchedProduct")),document.querySelector("#searchedProducts")&&function e(t){const r=document.querySelector("#searchedProducts");r.innerHTML="",""==t&&(r.innerHTML="<h1>Нічого не знайдено.</h1>");const n=t.trim().toLowerCase(),a=c.filter((e=>e.name.toLowerCase().includes(n)||e.description.toLowerCase().includes(n)||e.category.toLowerCase().includes(n)));a.length>0?a.forEach((e=>{const c=`\n                <figure class="col-6 col-md-4 col-lg-3">\n                  <figcaption>\n                    <div class="figure-image">\n                      <img src="${e.images[0]}" alt="${e.name}">\n                      <a href="product-card.html" class="figure-to-card-page" data-product-id="${e.id}"></a>\n                    </div>\n                    <div class="card-text-block d-flex justify-content-between w-100">\n                      <a href="product-card.html" class="description-card" data-product-id="${e.id}">\n                        <p>${e.name}</p>\n                        <p class="price">${e.price} грн.</p>\n                      </a>\n                      <a href="#" data-value="${e.id}" class="card-btn al-center d-flex justify-content-center">\n                        <img src="${JSON.parse(localStorage.getItem("basketProducts")||"[]").includes(e.id)?"img/tick.svg":"img/cart.svg"}" alt="cart">\n                      </a>\n                    </div>\n                  </figcaption>\n                </figure>\n              `;r.innerHTML+=c})):(r.innerHTML="<h1>Нічого не знайдено.</h1>",e(""))}(localStorage.getItem("searchedProduct"))}));